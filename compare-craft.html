<!DOCTYPE html>
<html lang="es">
<head>
  <meta name="app-version" content="1.0.0">
  <script>window.__APP_VERSION__='1.0.0';</script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="/img/favicon.ico" sizes="16x16" type="image/x-icon">
  <title>Comparador de Costes de Crafteo – Herramienta GW2</title>
  <link integrity="sha256-3KTGYB1FxMzkVqLV4zcAvVqwAMJWbsPxPT44jS0fUXk= sha384-oOV6TGLGOB+l2btdKi1rjgcdp5GrniPY9tUpd1v1UqfZHQcCV9yb7nrrf7ls9S9n" crossorigin="anonymous" rel="stylesheet" href="css/global-gw.css?v=1.0.0">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1YJ4M39JP3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1YJ4M39JP3');
</script>
</head>
<body>
  <header>
    <!-- El menú de navegación se insertará aquí automáticamente -->
  </header>
  <section class="services-menu">
    <div class="menu-grid-craft">
      <a href="#" class="menu-card-search-craft" id="open-search-modal">
        <div class="card-icon-craft">
          <img src="img/search.svg" alt="Buscador">
        </div>
        <div class="card-title">Buscador</div>
      </a>

    </div>
  </section>
  <div class="container">
    <div class="center-mb-25">
      <h2>Comparativa de items</h2>
      <p>Busca y añade items para comprar sus precios de crafteo y profit</p>
    </div>

    <div class="qty-global-container qty-controls">
      <div>
        <label for="qty-global" class="fw-500">Cantidad global:</label>
        <input id="qty-global" type="number" min="1" value="1" autocomplete="off">
      </div>
      <button id="btn-guardar-comparativa" class="tab-button ml-10" data-requires-login="true">Guardar comparativa</button>
    </div>

    <div id="item-header"></div>    

    <main>
      <!-- Secciones de Tabs -->
      
      
      <div id="error-message" class="error-message hidden"></div>
      <div id="wiki-links" class="hidden"></div>
      
      

      
      
      <div id="seccion-crafting"></div>
      <div id="item-skeleton" class="hidden">
        <div class="skeleton skeleton-result-line"></div>
        <div class="skeleton skeleton-result-line"></div>
        <div class="skeleton skeleton-result-line"></div>
        <div class="skeleton skeleton-result-line"></div>
        <div class="skeleton skeleton-result-line"></div>
      </div>
    </main>

  </div>


  
<script integrity="sha256-87vo3JTQvR8hiUpIET/1Sw8hG7NMdlSnMBO2PGBqSGI= sha384-7U8R/Hcnm6vIX8XXkf5zMCs3QJqpLnGD3e8H7qX8bwmEghlNbKI41bc8MbwvzUCw" crossorigin="anonymous" type="module" src="/dist/1.0.0/bundle-utils-1.B5CUuO5Q.min.js?v=1.0.0" defer></script>

  <!-- Modal del Buscador fuera de .container para igualar a index.html -->
  <div id="search-modal" class="search-modal hidden">
    <div class="search-modal-backdrop"></div>
    <div class="search-modal-content">
      <button class="close-modal" id="close-search-modal"></button>
      <input type="text" id="modal-search-input" placeholder="Buscar ítem por nombre..." autocomplete="off">
      <ul id="modal-suggestions" class="suggestions"></ul>
      <div id="modal-skeleton" class="hidden">
        <div class="skeleton skeleton-result-line"></div>
        <div class="skeleton skeleton-result-line"></div>
        <div class="skeleton skeleton-result-line"></div>
        <div class="skeleton skeleton-result-line"></div>
        <div class="skeleton skeleton-result-line"></div>
      </div>
      <div id="modal-error-message" class="error-message hidden"></div>
      <div id="modal-results" class="item-list"></div>
    </div>
  </div>
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    const openBtn = document.getElementById('open-search-modal');
    const modal = document.getElementById('search-modal');
    const closeBtn = document.getElementById('close-search-modal');
    openBtn.addEventListener('click', function(e) {
      e.preventDefault();
      openSearchModal(`/dist/1.0.0/search-modal-compare-craft.DMluxb5J.min.js?v=1.0.0`);
    });
    closeBtn.addEventListener('click', closeSearchModal);
    modal.querySelector('.search-modal-backdrop').addEventListener('click', closeSearchModal);
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') closeSearchModal();
    });
  });
  </script>

  <script integrity="sha256-sSYe36Ppke3VlFyDd2ybJf6m6OCCFDDkIqA7x4i6AQY= sha384-pM1rkIFevGHSBGiO8bIUzeWGz9ALncaqodQ7jOlIhX2TUmxTSPQhURLQieiv1npG" crossorigin="anonymous" type="module" src="/dist/1.0.0/tabs.min.js?v=1.0.0" defer></script>
  <script integrity="sha256-yI6ViVC5KFzl3iJ0vTf6VBnEz4JVDaVP7w/3PC3JtYU= sha384-1SklEHhqxptmXw2WXnv8CR0286+EboqTElpLhFpB1AvjirN2PhxYi2ldKS2TvJzy" crossorigin="anonymous" type="module" src="/dist/1.0.0/feedback-modal.BaGBwUid.min.js?v=1.0.0" defer></script>
  <!-- Nuevos módulos separados -->
<script integrity="sha256-jiYicGX7FwiECjWmt+NNxCeuMEJCmBQnEuQTG1tnFmk= sha384-pehemIhKJAAjKVz5D8QCnuGDqPSnxHtuTGeUI7aOz+x0Zl/2Us3nZE8az+PLau6k" crossorigin="anonymous" type="module" src="/dist/1.0.0/items-core.C2UiOsx8.min.js?v=1.0.0" defer></script>
  <script integrity="sha256-R+M6ezm7/xscFMBr76URi9FeVPq0yJvjjr1LNHNbMqw= sha384-QkV3s0swGoEKM0bj854INTn1cggdky2qJuUeFxiMzwezSUVxEEICgGI6RYMMBqlR" crossorigin="anonymous" type="module" src="/dist/1.0.0/ui-helpers.min.js?v=1.0.0" defer></script>
  <script integrity="sha256-Gec0VHBhBRit/OrpdE4FY/dSSDm3OCXmzvGn4yNlINs= sha384-HwuGuSxWLeOf+KQz6lvnK0A5bbaurhTu3/++yhsU07+w89yeujUMohmrJpgsw2BJ" crossorigin="anonymous" type="module" src="/dist/1.0.0/compare-ui.min.js?v=1.0.0" defer></script>

  <script>
  // Override global de selectItem para integración con el modal en compare-craft
  window.selectItem = function(id, e) {
  if (e) e.preventDefault();
  if (window.comparativa && typeof window.comparativa.agregarItemPorId === 'function') {
    window.comparativa.agregarItemPorId(Number(id));
    var input = document.getElementById('modal-search-input');
    var suggestions = document.getElementById('modal-suggestions');
    var results = document.getElementById('modal-results');
    if (input) input.value = '';
    if (suggestions) suggestions.innerHTML = '';
    if (results) results.innerHTML = '';
    if (input) input.focus();
    return false;
  }
  // Aquí puedes mostrar un mensaje de error visualmente, por consola, etc.
  alert('No se pudo agregar el ítem a la comparativa. Por favor intenta de nuevo.');
  // O si prefieres un mensaje en pantalla:
  var error = document.getElementById('modal-error-message');
  if (error) {
    error.textContent = 'No se pudo agregar el ítem a la comparativa.';
    error.style.display = 'block';
  }
  return false;
};

  </script>
<script integrity="sha256-e3+Ub3bujqc4mStLmN8oZtYHu4uZJPmYXFRju6AA6Q8= sha384-sjiNyBsvrZbgC7jV9c37FhMUW3NlFS5w2nNigt+nYWUXUPVQazy72nAB86+1MXxn" crossorigin="anonymous" type="module" src="/dist/1.0.0/bundle-auth-nav.CqVBeA8h.min.js?v=1.0.0" defer></script>
<script>
  // Inicializar autenticación cuando el DOM esté listo
  document.addEventListener('DOMContentLoaded', function() {
    if (window.Auth && typeof window.Auth.initAuth === 'function') {
      window.Auth.initAuth();
    }
  });
</script>

<script integrity="sha256-8rzUVrydB/9DUgSVg6mR2c2b34qWoLOeYP6f/3AVxXE= sha384-iv4HJ9zKO6XQwh0LYh2YP8SXcf36V0pA2YRCWVyEYcJHjR8SZcXw34JYqnBgyCI9" crossorigin="anonymous" type="module" src="/dist/1.0.0/storageUtils.min.js?v=1.0.0" defer></script>
<!-- Manejadores de comparativa (guardar comparativa) -->
<script integrity="sha256-RAgrz3w1Mi7pKDIa5QmJd0J61H2MUNFmKsq3rzIqrmQ= sha384-bpgUfvUhYm5fmUWHVhSUhtmthaWr9uK5eu4pXS4s0LDH7nC1N8sSHaJspcJJitoL" crossorigin="anonymous" type="module" src="/dist/1.0.0/compareHandlers.min.js?v=1.0.0" defer></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    if (window.comparativa &&
        typeof window.comparativa.loadComparativaFromURL === 'function') {
      window.comparativa.loadComparativaFromURL();
    }
  });
</script>
  <script integrity="sha256-FxLx+TVwUhON5UhF8ODw/UZ34gLsNlgyBGOTHEpSXrM= sha384-mP/SQYle5qV13Ergl1Q8JsstSEkgoty171bfXnrSAV7Zsv/BmMzB0+m5d/IrJj4K" crossorigin="anonymous" type="module" src="/dist/1.0.0/sw-register.Wot8iBZe.min.js?v=1.0.0"></script>
</body>
</html>
