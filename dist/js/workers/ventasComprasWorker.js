self.onmessage=e=>{const{history:t}=e.data||{};if(!Array.isArray(t)||0===t.length)return void self.postMessage({empty:!0});const a=t.map(e=>e.date||""),s=a[0]||"",r=a[a.length-1]||"",o=a.length,n=a.map(e=>{let t;if(e.includes("T")?t=new Date(e):/\d{4}-\d{2}-\d{2} \d{2}:\d{2}/.test(e)&&(t=new Date(e.replace(" ","T"))),t&&!isNaN(t))return`${t.getHours().toString().padStart(2,"0")}:00`;const a=e.match(/(\d{2}):(\d{2})/);return a?`${a[1]}:00`:e}),d=t.map(e=>e.sell_sold||0),l=t.map(e=>e.buy_sold||0);self.postMessage({etiquetas:n,ventas:d,compras:l,horaMin:s,horaMax:r,totalHoras:o})};
