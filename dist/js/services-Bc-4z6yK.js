import{g as e,f as t,s as r,a as n,p as s,b as i}from"./utils-BQXvdNd9.js";const a="undefined"!=typeof process&&process.env?process.env:{},c=a.API_BASE_URL||"https://api.guildwars2.com/v2",o=a.LANG||"es";a.MARKET_CSV_URL,a.GW2_API_KEY;var u={API_BASE_URL:c,LANG:o,priceCacheStrategy:a.PRICE_CACHE_STRATEGY||"sessionStorage"};const l=u.API_BASE_URL;async function p(n=[]){if(!Array.isArray(n)||0===n.length)return[];const s=new Map,i=[];if(n.forEach(t=>{const r=e(`bundle_${t}`);r?s.set(t,r):i.push(t)}),i.length>0){const e=i.map(e=>`ids[]=${e}`).join("&");t(`/backend/api/dataBundle.php?${e}`).then(e=>e.ok?e.json():null).then(e=>{e&&e.forEach(e=>{r(`bundle_${e.id}`,e),window.dispatchEvent(new CustomEvent("bundleItemRefreshed",{detail:e}))})}).catch(e=>console.error("Error en getItemBundles:",e))}return n.map(e=>s.get(e)||null)}async function d(e){const t=Array.isArray(e)?e:[e],r=await p(t);if(Array.isArray(e))return r.map(e=>e?.recipe?[e.recipe]:[]);const n=r[0]?.recipe;return n?[n]:[]}async function _(t){const s=`recipe_${t}`,i=e(s,!0);try{const e=await n(`${l}/recipes/${t}`,{},s,i);if(!e.ok)return null;const a=await e.json();if(!a)return null;a.lastUpdated=(new Date).toISOString();const c=e.headers.get("ETag"),o=e.headers.get("Last-Modified");return r(s,a,void 0,{etag:c,lastModified:o}),a}catch(e){return console.error("Error en getRecipeDetails:",e),null}}async function g(e){if(Array.isArray(e)){return(await p(e)).map(e=>e?.item||null)}const t=await p([e]);return t[0]?.item||null}async function w(e){if(Array.isArray(e)){const t=await s(e);return e.map(e=>{const r=t.get(e)||{};return{buys:{unit_price:r.buy_price||0},sells:{unit_price:r.sell_price||0}}})}const t=await i(e);return{buys:{unit_price:t?.buy_price||0},sells:{unit_price:t?.sell_price||0}}}"undefined"!=typeof window&&(window.getRecipesForItem=d,window.getRecipeDetails=_,window.getItemDetails=g,window.getItemPrices=w,window.getItemBundles=p);var f=Object.freeze({__proto__:null,getItemBundles:p,getItemDetails:g,getItemPrices:w,getRecipeDetails:_,getRecipesForItem:d});export{u as c,f as r};
