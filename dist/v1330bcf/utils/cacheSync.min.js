const channel="undefined"!=typeof window&&"BroadcastChannel"in window?new BroadcastChannel("cache-sync"):null;let store=null;export function setupCacheSync(e){store=e,channel&&channel.addEventListener("message",({data:e})=>{const{type:n,key:t,entry:s}=e||{};if("request-bundles"!==n)n&&t&&("set"===n&&s?store.set(t,s):"delete"===n&&store.delete(t));else{if(!store)return;store.forEach((e,n)=>{n.startsWith("bundle_")&&channel.postMessage({type:"set",key:n,entry:e})})}})}export function notifySet(e,n){channel&&channel.postMessage({type:"set",key:e,entry:n})}export function notifyDelete(e){channel&&channel.postMessage({type:"delete",key:e})}export function requestBundleSync(){channel&&channel.postMessage({type:"request-bundles"})}