import{f as e}from"./utils-BH_A_QOU.js";import"./services-BkFipzNj.js";const t={},o={};async function r(r=[]){if(r.length)try{const i=await e(`https://api.guildwars2.com/v2/items?ids=${r.join(",")}&lang=es`);(await i.json()).forEach(e=>{e&&e.id&&(t[e.id]=e.icon,o[e.id]=e.rarity)})}catch{}}async function i(t=[]){if(!t||0===t.length)return new Map;const o=`https://api.datawars2.ie/gw2/v1/items/csv?fields=id,buy_price,sell_price&ids=${t.join(",")}`;try{const t=await e(o).then(e=>e.text()),[r,...i]=t.trim().split("\n"),c=r.split(","),n=c.indexOf("id"),a=c.indexOf("buy_price"),s=c.indexOf("sell_price"),l=new Map;return i.forEach(e=>{const t=e.split(","),o=parseInt(t[n],10);isNaN(o)||l.set(o,{buy_price:parseInt(t[a],10)||0,sell_price:parseInt(t[s],10)||0})}),l}catch(e){return new Map}}function c(e,t){if(!e||!t)return;const o=e.querySelector("div");if(!o||o.querySelector("img"))return;const r=document.createElement("img");r.src=t,r.className="item-icon",o.prepend(r)}"undefined"!=typeof window&&(window.FractalesUtils={fetchIconsFor:r,fetchItemPrices:i,iconCache:t,rarityCache:o});const n={t6:{sangre:24295,hueso:24358,garra:24351,colmillo:24357,escama:24289,totem:24300,veneno:24283},t5:{sangre:24294,hueso:24341,garra:24350,colmillo:24356,escama:24288,totem:24299,veneno:24282},polvo:24277,piedra:20796},a={cores:{glacial:24319,cristal:24329,destructor:24324,cargado:24304,corrupto:24339,onice:24309,fundido:24314},stones:{glacial:24320,cristal:24330,destructor:24325,cargado:24305,corrupto:24340,onice:24310,fundido:24315},polvo:24277,botella:19663,cristal:20799};document.addEventListener("DOMContentLoaded",()=>{!async function(){const e=Object.keys(n.t5),o=[...e.map(e=>n.t5[e]),...e.map(e=>n.t6[e]),n.polvo,n.piedra],a=await i(o);await r(o),e.forEach(e=>{const o=document.querySelector(`#matt5t6 tr[data-key="${e}"]`);if(!o)return;const r=o.querySelector(".sum-mats"),i=o.querySelector(".resultado"),s=o.querySelector(".profit"),l=a.get(n.t5[e])?.buy_price||0,d=a.get(n.t6[e])?.buy_price||0,p=a.get(n.t6[e])?.sell_price||0,u=50*l+5*(a.get(n.polvo)?.buy_price||0)+5*(a.get(n.piedra)?.buy_price||0)+d,m=6.91*p*.85,y=m-u;r&&(r.innerHTML=window.formatGoldColored(u)),i&&(i.innerHTML=window.formatGoldColored(m)),s&&(s.innerHTML=window.formatGoldColored(y));const f=o.querySelectorAll("td");c(f[0],t[n.t5[e]]),c(f[1],t[n.t6[e]]),c(f[2],t[n.polvo]),c(f[3],t[n.piedra])})}(),async function(){const e=Object.keys(a.cores),o=[...e.map(e=>a.cores[e]),...e.map(e=>a.stones[e]),a.polvo,a.botella,a.cristal],n=await i(o);await r(o),e.forEach(e=>{const o=document.querySelector(`#tabla-lodestones tr[data-key="${e}"]`);if(!o)return;const r=o.querySelector(".sum-mats"),i=o.querySelector(".profit"),s=n.get(a.cores[e])?.buy_price||0,l=n.get(a.stones[e])?.sell_price||0,d=2*s+(n.get(a.polvo)?.buy_price||0)+(n.get(a.botella)?.buy_price||0)+(n.get(a.cristal)?.buy_price||0),p=.85*l-d;r&&(r.innerHTML=window.formatGoldColored(d)),i&&(i.innerHTML=window.formatGoldColored(p));const u=o.querySelectorAll("td");c(u[0],t[a.cores[e]]),c(u[1],t[a.polvo]),c(u[2],t[a.botella]),c(u[3],t[a.cristal]),c(u[4],t[a.stones[e]])})}()});
