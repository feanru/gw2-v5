import apiHealth from"./apiHealth.min.js";export{apiHealth};export default async function fetchWithRetry(t,e={}){const{timeout:a=8e3,retries:o=3,backoff:r=300,signal:i,...c}=e;for(let e=0;e<=o;e++){const n=new AbortController,s=setTimeout(()=>n.abort(),a);i&&(i.aborted?n.abort():i.addEventListener("abort",()=>n.abort(),{once:!0}));try{const e=await fetch(t,{...c,signal:n.signal});return clearTimeout(s),apiHealth.recordSuccess(),e}catch(t){if(clearTimeout(s),apiHealth.recordFailure(),i?.aborted||e===o)throw t;const a=r*Math.pow(2,e);await new Promise(t=>setTimeout(t,a))}}}