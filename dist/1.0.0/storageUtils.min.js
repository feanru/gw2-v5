import{f as r}from"./utils-BAeLe99y.js";async function e(){try{const e=await r("backend/api/favorites.php");if(!e.ok)return[];const t=await e.json();return Array.isArray(t)?t.map(r=>({id:parseInt(r,10)})):[]}catch(r){return console.error("Error obteniendo favoritos",r),[]}}async function t(){try{const e=await r("backend/api/comparisons.php");if(!e.ok)return[];const t=await e.json(),a=r=>{if(!r)return[];try{return Array.isArray(r)?r:JSON.parse(r)}catch{return[]}},o=(r,e,t)=>{if(r)try{return(Array.isArray(r)?r:JSON.parse(r)).map(r=>Number(r))}catch{}return[Number(e),Number(t)].filter(r=>!isNaN(r))};return Array.isArray(t)?t.map(r=>({id:r.id,ids:o(r.item_ids,r.item_left,r.item_right),nombres:a(r.item_names)})):[]}catch(r){return console.error("Error obteniendo comparativas",r),[]}}window.StorageUtils={saveFavorito:async function(t){if(!t||!t.id)return[];try{await r("backend/api/favorites.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_id:t.id})})}catch(r){console.error("Error guardando favorito",r)}return navigator.serviceWorker?.controller?.postMessage({type:"invalidate",url:"backend/api/favorites.php"}),e()},getFavoritos:e,removeFavorito:async function(t){try{await r(`backend/api/favorites.php?item_id=${t}`,{method:"DELETE"})}catch(r){console.error("Error eliminando favorito",r)}return navigator.serviceWorker?.controller?.postMessage({type:"invalidate",url:"backend/api/favorites.php"}),e()},saveComparativa:async function(e){if(!e||!Array.isArray(e.ids)||e.ids.length<2)return[];try{await r("backend/api/comparisons.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_ids:e.ids,item_names:e.nombres})})}catch(r){console.error("Error guardando comparativa",r)}return navigator.serviceWorker?.controller?.postMessage({type:"invalidate",url:"backend/api/comparisons.php"}),t()},getComparativas:t,removeComparativa:async function(e){try{await r(`backend/api/comparisons.php?id=${e}`,{method:"DELETE"})}catch(r){console.error("Error eliminando comparativa",r)}return navigator.serviceWorker?.controller?.postMessage({type:"invalidate",url:"backend/api/comparisons.php"}),t()},showToast:function(r,e="success"){let t=document.getElementById("toast-container");t||(t=document.createElement("div"),t.id="toast-container",t.className="toast-container",document.body.appendChild(t));const a=document.createElement("div");a.className=`toast toast-${e}`,a.style.opacity="0",a.textContent=r,t.appendChild(a),setTimeout(()=>{a.style.opacity="1"},10),setTimeout(()=>{a.style.opacity="0",setTimeout(()=>{a.remove(),0===t.children.length&&t.remove()},300)},3e3)}};
//# sourceMappingURL=storageUtils.min.v1.0.0.js.map
